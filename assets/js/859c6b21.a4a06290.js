"use strict";(globalThis.webpackChunkdatabasement_docs=globalThis.webpackChunkdatabasement_docs||[]).push([[977],{2400:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>i,default:()=>p,frontMatter:()=>o,metadata:()=>a,toc:()=>d});const a=JSON.parse('{"id":"self-hosting/guides/docker-compose","title":"Docker Compose","description":"This guide will help you deploy Databasement using Docker Compose. This method is ideal when you want to run Databasement alongside its own dedicated database container.","source":"@site/docs/self-hosting/guides/docker-compose.md","sourceDirName":"self-hosting/guides","slug":"/self-hosting/guides/docker-compose","permalink":"/databasement/self-hosting/guides/docker-compose","draft":false,"unlisted":false,"editUrl":"https://github.com/David-Crty/databasement/tree/main/docs/docs/self-hosting/guides/docker-compose.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2},"sidebar":"selfHostingSidebar","previous":{"title":"Docker","permalink":"/databasement/self-hosting/guides/docker"},"next":{"title":"Kubernetes + Helm","permalink":"/databasement/self-hosting/guides/kubernetes-helm"}}');var t=s(4848),r=s(8453);const o={sidebar_position:2},i="Docker Compose",c={},d=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Quick Start",id:"quick-start",level:2},{value:"1. Create Project Directory",id:"1-create-project-directory",level:3},{value:"2. Generate Application Key",id:"2-generate-application-key",level:3},{value:"3. Create docker-compose.yml",id:"3-create-docker-composeyml",level:3},{value:"4. Start the Services",id:"4-start-the-services",level:3},{value:"5. Access the Application",id:"5-access-the-application",level:3},{value:"With PostgreSQL",id:"with-postgresql",level:2},{value:"With Traefik (HTTPS)",id:"with-traefik-https",level:2},{value:"Using Environment Files",id:"using-environment-files",level:2},{value:"Common Operations",id:"common-operations",level:2},{value:"View Logs",id:"view-logs",level:3},{value:"Restart Services",id:"restart-services",level:3},{value:"Stop Services",id:"stop-services",level:3},{value:"Update",id:"update",level:3},{value:"Backup the Database",id:"backup-the-database",level:3},{value:"Run Artisan Commands",id:"run-artisan-commands",level:3}];function l(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"docker-compose",children:"Docker Compose"})}),"\n",(0,t.jsx)(n.p,{children:"This guide will help you deploy Databasement using Docker Compose. This method is ideal when you want to run Databasement alongside its own dedicated database container."}),"\n",(0,t.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"https://docs.docker.com/engine/install/",children:"Docker"})," and ",(0,t.jsx)(n.a,{href:"https://docs.docker.com/compose/install/",children:"Docker Compose"})]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"quick-start",children:"Quick Start"}),"\n",(0,t.jsx)(n.h3,{id:"1-create-project-directory",children:"1. Create Project Directory"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"mkdir databasement && cd databasement\n"})}),"\n",(0,t.jsx)(n.h3,{id:"2-generate-application-key",children:"2. Generate Application Key"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"docker run --rm davidcrty/databasement:latest php artisan key:generate --show\n"})}),"\n",(0,t.jsx)(n.p,{children:"Save this key for the next step."}),"\n",(0,t.jsx)(n.h3,{id:"3-create-docker-composeyml",children:"3. Create docker-compose.yml"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",metastring:'title="docker-compose.yml"',children:'services:\n  app:\n    image: davidcrty/databasement:latest\n    container_name: databasement\n    restart: unless-stopped\n    ports:\n      - "8000:8000"\n    environment:\n      APP_NAME: Databasement\n      APP_ENV: production\n      APP_DEBUG: "false"\n      APP_URL: http://localhost:8000\n      APP_KEY: base64:your-generated-key-here\n      DB_CONNECTION: mysql\n      DB_HOST: db\n      DB_PORT: 3306\n      DB_DATABASE: databasement\n      DB_USERNAME: databasement\n      DB_PASSWORD: secure-password-change-me\n      LOG_CHANNEL: stderr\n      MYSQL_CLI_TYPE: mariadb\n    volumes:\n      - storage:/app/storage\n    depends_on:\n      db:\n        condition: service_healthy\n\n  db:\n    image: mysql:8.0\n    container_name: databasement-db\n    restart: unless-stopped\n    environment:\n      MYSQL_ROOT_PASSWORD: root-password-change-me\n      MYSQL_DATABASE: databasement\n      MYSQL_USER: databasement\n      MYSQL_PASSWORD: secure-password-change-me\n    volumes:\n      - mysql-data:/var/lib/mysql\n    healthcheck:\n      test: ["CMD", "mysqladmin", "ping", "-h", "localhost"]\n      interval: 10s\n      timeout: 5s\n      retries: 5\n\nvolumes:\n  storage:\n  mysql-data:\n'})}),"\n",(0,t.jsx)(n.h3,{id:"4-start-the-services",children:"4. Start the Services"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"docker compose up -d\n"})}),"\n",(0,t.jsx)(n.h3,{id:"5-access-the-application",children:"5. Access the Application"}),"\n",(0,t.jsxs)(n.p,{children:["Open ",(0,t.jsx)(n.a,{href:"http://localhost:8000",children:"http://localhost:8000"})," in your browser."]}),"\n",(0,t.jsx)(n.h2,{id:"with-postgresql",children:"With PostgreSQL"}),"\n",(0,t.jsx)(n.p,{children:"If you prefer PostgreSQL:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",metastring:'title="docker-compose.yml"',children:'services:\n  app:\n    image: davidcrty/databasement:latest\n    container_name: databasement\n    restart: unless-stopped\n    ports:\n      - "8000:8000"\n    environment:\n      APP_NAME: Databasement\n      APP_ENV: production\n      APP_DEBUG: "false"\n      APP_URL: http://localhost:8000\n      APP_KEY: base64:your-generated-key-here\n      DB_CONNECTION: pgsql\n      DB_HOST: db\n      DB_PORT: 5432\n      DB_DATABASE: databasement\n      DB_USERNAME: databasement\n      DB_PASSWORD: secure-password-change-me\n      LOG_CHANNEL: stderr\n    volumes:\n      - storage:/app/storage\n    depends_on:\n      db:\n        condition: service_healthy\n\n  db:\n    image: postgres:16\n    container_name: databasement-db\n    restart: unless-stopped\n    environment:\n      POSTGRES_DB: databasement\n      POSTGRES_USER: databasement\n      POSTGRES_PASSWORD: secure-password-change-me\n    volumes:\n      - postgres-data:/var/lib/postgresql/data\n    healthcheck:\n      test: ["CMD-SHELL", "pg_isready -U databasement -d databasement"]\n      interval: 10s\n      timeout: 5s\n      retries: 5\n\nvolumes:\n  storage:\n  postgres-data:\n'})}),"\n",(0,t.jsx)(n.h2,{id:"with-traefik-https",children:"With Traefik (HTTPS)"}),"\n",(0,t.jsx)(n.p,{children:"For production with automatic HTTPS using Traefik:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",metastring:'title="docker-compose.yml"',children:'services:\n  traefik:\n    image: traefik:v3.0\n    container_name: traefik\n    restart: unless-stopped\n    command:\n      - "--api.insecure=true"\n      - "--providers.docker=true"\n      - "--providers.docker.exposedbydefault=false"\n      - "--entrypoints.web.address=:80"\n      - "--entrypoints.websecure.address=:443"\n      - "--certificatesresolvers.letsencrypt.acme.httpchallenge=true"\n      - "--certificatesresolvers.letsencrypt.acme.httpchallenge.entrypoint=web"\n      - "--certificatesresolvers.letsencrypt.acme.email=your-email@example.com"\n      - "--certificatesresolvers.letsencrypt.acme.storage=/letsencrypt/acme.json"\n    ports:\n      - "80:80"\n      - "443:443"\n    volumes:\n      - /var/run/docker.sock:/var/run/docker.sock:ro\n      - letsencrypt:/letsencrypt\n\n  app:\n    image: davidcrty/databasement:latest\n    container_name: databasement\n    restart: unless-stopped\n    environment:\n      APP_NAME: Databasement\n      APP_ENV: production\n      APP_DEBUG: "false"\n      APP_URL: https://backup.yourdomain.com\n      APP_KEY: base64:your-generated-key-here\n      DB_CONNECTION: mysql\n      DB_HOST: db\n      DB_PORT: 3306\n      DB_DATABASE: databasement\n      DB_USERNAME: databasement\n      DB_PASSWORD: secure-password-change-me\n      LOG_CHANNEL: stderr\n      MYSQL_CLI_TYPE: mariadb\n    volumes:\n      - storage:/app/storage\n    depends_on:\n      db:\n        condition: service_healthy\n    labels:\n      - "traefik.enable=true"\n      - "traefik.http.routers.databasement.rule=Host(`backup.yourdomain.com`)"\n      - "traefik.http.routers.databasement.entrypoints=websecure"\n      - "traefik.http.routers.databasement.tls.certresolver=letsencrypt"\n      - "traefik.http.services.databasement.loadbalancer.server.port=8000"\n\n  db:\n    image: mysql:8.0\n    container_name: databasement-db\n    restart: unless-stopped\n    environment:\n      MYSQL_ROOT_PASSWORD: root-password-change-me\n      MYSQL_DATABASE: databasement\n      MYSQL_USER: databasement\n      MYSQL_PASSWORD: secure-password-change-me\n    volumes:\n      - mysql-data:/var/lib/mysql\n    healthcheck:\n      test: ["CMD", "mysqladmin", "ping", "-h", "localhost"]\n      interval: 10s\n      timeout: 5s\n      retries: 5\n\nvolumes:\n  storage:\n  mysql-data:\n  letsencrypt:\n'})}),"\n",(0,t.jsx)(n.h2,{id:"using-environment-files",children:"Using Environment Files"}),"\n",(0,t.jsxs)(n.p,{children:["For better security, use a separate ",(0,t.jsx)(n.code,{children:".env"})," file:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",metastring:'title=".env"',children:"# Application\nAPP_NAME=Databasement\nAPP_ENV=production\nAPP_DEBUG=false\nAPP_URL=https://backup.yourdomain.com\nAPP_KEY=base64:your-generated-key-here\n\n# Database\nDB_CONNECTION=mysql\nDB_HOST=db\nDB_PORT=3306\nDB_DATABASE=databasement\nDB_USERNAME=databasement\nDB_PASSWORD=secure-password-change-me\n\n# MySQL Root (for db container)\nMYSQL_ROOT_PASSWORD=root-password-change-me\n\n# Other\nLOG_CHANNEL=stderr\nMYSQL_CLI_TYPE=mariadb\n"})}),"\n",(0,t.jsx)(n.p,{children:"Then reference it in your compose file:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",metastring:'title="docker-compose.yml"',children:"services:\n  app:\n    image: davidcrty/databasement:latest\n    env_file: .env\n    # ... rest of config\n"})}),"\n",(0,t.jsx)(n.h2,{id:"common-operations",children:"Common Operations"}),"\n",(0,t.jsx)(n.h3,{id:"view-logs",children:"View Logs"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"docker compose logs -f         # All services\ndocker compose logs -f app     # Just the app\ndocker compose logs -f db      # Just the database\n"})}),"\n",(0,t.jsx)(n.h3,{id:"restart-services",children:"Restart Services"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"docker compose restart\ndocker compose restart app     # Just the app\n"})}),"\n",(0,t.jsx)(n.h3,{id:"stop-services",children:"Stop Services"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"docker compose down            # Stop containers\ndocker compose down -v         # Stop and remove volumes (data loss!)\n"})}),"\n",(0,t.jsx)(n.h3,{id:"update",children:"Update"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"docker compose pull\ndocker compose up -d\n"})}),"\n",(0,t.jsx)(n.h3,{id:"backup-the-database",children:"Backup the Database"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# MySQL\ndocker compose exec db mysqldump -u databasement -p databasement > backup.sql\n\n# PostgreSQL\ndocker compose exec db pg_dump -U databasement databasement > backup.sql\n"})}),"\n",(0,t.jsx)(n.h3,{id:"run-artisan-commands",children:"Run Artisan Commands"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"docker compose exec app php artisan migrate:status\ndocker compose exec app php artisan tinker\n"})})]})}function p(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(l,{...e})}):l(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>o,x:()=>i});var a=s(6540);const t={},r=a.createContext(t);function o(e){const n=a.useContext(r);return a.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),a.createElement(r.Provider,{value:n},e.children)}}}]);